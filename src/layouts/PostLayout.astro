---
import BaseLayout from "./BaseLayout.astro";

interface Props {
  frontmatter: {
    title: string;
    description?: string;
    date?: string;
    useKatex?: boolean;
    useD3?: boolean;
    scripts?: string[];
    category?: string;
  };
  post?: {
    id?: string;
    collection?: string;
    slug?: string;
  };
  headings?: Array<{
    depth: number;
    slug: string;
    text: string;
  }>;
}

const { frontmatter, headings = [] } = Astro.props as Props;
const { title, description, useKatex = false, useD3 = false } = frontmatter;

let documentTitle = title;
---

<BaseLayout title={documentTitle} description={description}>
  <Fragment slot="head">
    {
      useKatex && (
        <link
          rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"
          integrity="sha384-5TcZemv2l/9On385z///+d7MSYlvIEw9FuZTIdZ14vJLqWphw7e7ZPuOiCHJcFCP"
          crossorigin="anonymous"
        />
      )
    }
    {useD3 && <script src="https://d3js.org/d3.v7.min.js" is:inline />}
    <slot name="head" />
  </Fragment>

  <Fragment>
    <div>
      <header>
        <h1>{title}</h1>
        {frontmatter.date}
      </header>}
    </div>
    <article>
      <slot />
    </article>
  </Fragment>
</BaseLayout>

<Fragment slot="scripts">
  <script src="/scripts/centerKatex.js" is:inline></script>
  {frontmatter.scripts?.map((src) => <script src={src} is:inline />)}
  <slot name="scripts" />
</Fragment>
